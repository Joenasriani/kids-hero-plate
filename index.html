<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hero Academy: Healthy Plate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700;800&display=swap');
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: f0fdf4; 
            margin: 0; 
            overflow: hidden; 
            touch-action: none; 
        }
        .hero-gradient { 
            background: radial-gradient(circle at top right, d1fae5 0%, transparent 50%), radial-gradient(circle at bottom left, fef3c7 0%, transparent 50%); 
        }
        /* Adaptive scaling using vmin to prevent overflow on any aspect ratio */
        .fluid-title { font-size: clamp(2rem, 10vmin, 12rem); }
        .fluid-subtitle { font-size: clamp(0.8rem, 2vmin, 3rem); }
        .fluid-question { font-size: clamp(2rem, 9vmin, 14rem); }
        .fluid-emoji { font-size: clamp(100px, 35vmin, 450px); }
        .fluid-points { font-size: clamp(1.2rem, 4vmin, 6rem); }
        .fluid-button { font-size: clamp(1rem, 3vmin, 5rem); }
        .fluid-feedback { font-size: clamp(1.2rem, 3.5vmin, 7rem); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;
        const { motion, AnimatePresence } = window.Motion;

        const Icons = {
            Apple: ({ className }) => <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M12 8c1.657 0 3 .895 3 2s-1.343 2-3 2-3-.895-3-2 1.343-2 3-2z"/><path d="M12 12v6"/></svg>,
            Star: ({ className, fill }) => <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill={fill || "none"} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            RefreshCcw: ({ size }) => <svg width={size} height={size} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></svg>,
            Smartphone: ({ className }) => <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>,
            Trophy: ({ className }) => <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
            CheckCircle2: ({ className }) => <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            XCircle: ({ className }) => <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>,
            Maximize: ({ size }) => (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round">
                    <path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7" />
                </svg>
            ),
            Minimize: ({ size }) => (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round">
                    <path d="M4 12h8m0 0V4m0 8l-8-8M20 12h-8m0 0v8m0-8l8 8" />
                </svg>
            )
        };

        const Confetti = () => {
            const colors = ['10b981', '3b82f6', 'f59e0b', 'ef4444', '8b5cf6'];
            const pieces = useMemo(() => {
                return Array.from({ length: 80 }).map((_, i) => {
                    const isLeft = i < 40;
                    return {
                        id: i,
                        color: colors[Math.floor(Math.random() * colors.length)],
                        initialX: isLeft ? -5 : 105,
                        targetX: isLeft ? Math.random() * 60 : 40 + Math.random() * 60,
                        sway: (Math.random() - 0.5) * 15,
                        duration: 3 + Math.random() * 2,
                        delay: Math.random() * 0.5,
                        rotation: Math.random() * 1080
                    };
                });
            }, []);

            return (
                <div className="fixed inset-0 pointer-events-none z-[120] overflow-hidden">
                    {pieces.map((p) => (
                        <motion.div
                            key={p.id}
                            initial={{ top: "-10%", left: `${p.initialX}%`, scale: 0, rotate: 0 }}
                            animate={{ 
                                top: ["-10%", "20%", "115%"],
                                left: [`${p.initialX}%`, `${p.targetX}%`, `${p.targetX + p.sway}%`],
                                scale: [0, 1.2, 1],
                                rotate: p.rotation
                            }}
                            transition={{ duration: p.duration, times: [0, 0.1, 1], ease: "easeOut", delay: p.delay }}
                            className="absolute w-[1vmin] h-[2vmin] rounded-sm shadow-sm"
                            style={{ backgroundColor: `${p.color}` }}
                        />
                    ))}
                </div>
            );
        };

        function App() {
            const [gameState, setGameState] = useState('menu'); 
            const [score, setScore] = useState(0);
            const [currentIdx, setCurrentIdx] = useState(0);
            const [userAnswers, setUserAnswers] = useState([]);
            const [sessionItems, setSessionItems] = useState([]);
            const [orientation, setOrientation] = useState('landscape');
            const [isFullscreen, setIsFullscreen] = useState(false);
            const [finalMessage, setFinalMessage] = useState('');
            const [showPlayAgain, setShowPlayAgain] = useState(false);

            const ITEM_BANK = [
                { type: 'healthy', icon: 'ðŸŽ', name: 'Apple' },
                { type: 'unhealthy', icon: 'ðŸ­', name: 'Candy' },
                { type: 'healthy', icon: 'ðŸ¥¦', name: 'Broccoli' },
                { type: 'healthy', icon: 'ðŸ’§', name: 'Water' },
                { type: 'unhealthy', icon: 'ðŸ¥¤', name: 'Soda' },
                { type: 'healthy', icon: 'ðŸ¥•', name: 'Carrot' },
                { type: 'unhealthy', icon: 'ðŸ•', name: 'Pizza' },
                { type: 'healthy', icon: 'ðŸŒ', name: 'Banana' },
                { type: 'unhealthy', icon: 'ðŸ©', name: 'Donut' },
                { type: 'healthy', icon: 'ðŸ“', name: 'Strawberry' },
                { type: 'unhealthy', icon: 'ðŸŸ', name: 'Fries' },
                { type: 'healthy', icon: 'ðŸ¥š', name: 'Egg' },
                { type: 'unhealthy', icon: 'ðŸ”', name: 'Burger' },
                { type: 'healthy', icon: 'ðŸ‰', name: 'Watermelon' },
                { type: 'unhealthy', icon: 'ðŸ¦', name: 'Ice Cream' },
                { type: 'healthy', icon: 'ðŸ‡', name: 'Grapes' },
                { type: 'healthy', icon: 'ðŸŒ½', name: 'Corn' },
                { type: 'healthy', icon: 'ðŸŠ', name: 'Orange' },
                { type: 'unhealthy', icon: 'ðŸ°', name: 'Cake' },
                { type: 'unhealthy', icon: 'ðŸŒ­', name: 'Hot Dog' }
            ];

            const MESSAGE_BANK = [
                "You are doing a great job with your choices!",
                "Nice work picking good fuel for your body!",
                "You are learning so much about healthy food!",
                "Great effort on choosing your power-ups!"
            ];

            // Idle Timer Logic (3 minutes)
            useEffect(() => {
                let idleTimeout;
                const resetTimer = () => {
                    if (idleTimeout) clearTimeout(idleTimeout);
                    idleTimeout = setTimeout(() => {
                        if (gameState !== 'menu') setGameState('menu');
                    }, 180000);
                };

                if (gameState !== 'menu') {
                    resetTimer();
                    const events = ['mousemove', 'mousedown', 'touchstart', 'keydown'];
                    events.forEach(e => window.addEventListener(e, resetTimer));
                    return () => {
                        clearTimeout(idleTimeout);
                        events.forEach(e => window.removeEventListener(e, resetTimer));
                    };
                }
            }, [gameState]);

            useEffect(() => {
                const checkOrientation = () => setOrientation(window.innerWidth > window.innerHeight ? 'landscape' : 'portrait');
                const handleFSChange = () => setIsFullscreen(!!document.fullscreenElement);
                window.addEventListener('resize', checkOrientation);
                document.addEventListener('fullscreenchange', handleFSChange);
                checkOrientation();
                return () => {
                    window.removeEventListener('resize', checkOrientation);
                    document.removeEventListener('fullscreenchange', handleFSChange);
                };
            }, []);

            useEffect(() => {
                if (gameState === 'result') {
                    setShowPlayAgain(false);
                    const timer = setTimeout(() => setShowPlayAgain(true), 1200);
                    return () => clearTimeout(timer);
                }
            }, [gameState]);

            const toggleFullScreen = () => {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(() => {});
                } else {
                    if (document.exitFullscreen) document.exitFullscreen();
                }
            };

            const startGame = () => {
                const shuffledItems = [...ITEM_BANK].sort(() => 0.5 - Math.random()).slice(0, 10);
                setSessionItems(shuffledItems);
                setScore(0);
                setCurrentIdx(0);
                setUserAnswers([]);
                setGameState('game');
            };

            const handleChoice = (choice) => {
                const currentItem = sessionItems[currentIdx];
                const isCorrect = currentItem.type === choice;
                const newScore = isCorrect ? score + 10 : score;
                setScore(newScore);
                const updatedAnswers = [...userAnswers, { ...currentItem, wasCorrect: isCorrect }];
                setUserAnswers(updatedAnswers);

                if (currentIdx < 9) {
                    setCurrentIdx(currentIdx + 1);
                } else {
                    if (newScore >= 90) {
                        setFinalMessage(MESSAGE_BANK[Math.floor(Math.random() * MESSAGE_BANK.length)]);
                    } else if (newScore >= 60 && newScore <= 80) {
                        setFinalMessage("Good enough, but let's try to make better, healthier choices next time!");
                    } else if (newScore <= 30) {
                        setFinalMessage("Not good enough! You can do much better! Try choosing healthier food next time!");
                    } else {
                        setFinalMessage("You are learning! Practice choosing healthy snacks to get even stronger!");
                    }
                    setTimeout(() => setGameState('result'), 500);
                }
            };

            return (
                <div className="fixed inset-0 bg-emerald-50 hero-gradient overflow-hidden flex flex-col h-[100dvh] p-[2vmin]">
                    {orientation === 'portrait' && gameState === 'game' && (
                        <div className="fixed inset-0 z-[150] bg-slate-900 flex flex-col items-center justify-center text-white p-6 text-center">
                            <Icons.Smartphone className="w-[10vmin] h-[10vmin] mb-4 animate-bounce text-emerald-400" />
                            <p className="font-black uppercase tracking-widest text-[4vmin] text-amber-500">Rotate for Landscape</p>
                        </div>
                    )}

                    <button 
                        onClick={toggleFullScreen} 
                        className="fixed top-[3vmin] right-[3vmin] z-[130] bg-white/95 backdrop-blur p-[2vmin] rounded-full shadow-xl border-2 border-emerald-100 text-emerald-600 active:scale-90 transition-all flex items-center justify-center"
                    >
                        {isFullscreen ? <Icons.Minimize size="3vmin" /> : <Icons.Maximize size="3vmin" />}
                    </button>

                    {gameState === 'game' && (
                        <header className="flex-none w-full flex justify-between items-center z-10 mb-[2vmin] pr-[8vmin]">
                            <div className="flex items-center gap-[1.5vmin] bg-white px-[3vmin] py-[1.5vmin] rounded-2xl border-[0.4vmin] border-emerald-200 shadow-lg">
                                <Icons.Star className="w-[4vmin] h-[4vmin] text-yellow-500" fill="currentColor" />
                                <span className="fluid-points font-[900] text-emerald-600 leading-none">{score}</span>
                            </div>
                            <div className="flex-1 max-w-[30vw] mx-[4vmin]">
                                <div className="bg-slate-200 h-[1.5vmin] rounded-full overflow-hidden border-[0.2vmin] border-white shadow-inner">
                                    <div style={{ width: `${(currentIdx / 10) * 100}%` }} className="bg-emerald-500 h-full transition-all duration-300" />
                                </div>
                            </div>
                            <div className="text-[2.5vmin] font-black text-slate-400 uppercase tracking-tighter hidden md:block">
                                {currentIdx + 1} / 10
                            </div>
                        </header>
                    )}

                    <main className="flex-1 relative flex items-center justify-center min-h-0">
                        <AnimatePresence mode="wait">
                            {gameState === 'menu' && (
                                <motion.div key="menu" initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} className="w-full max-w-[80vw] h-fit bg-white p-[6vmin] rounded-[5vmin] shadow-2xl border-b-[1.5vmin] border-emerald-100 text-center flex flex-col items-center justify-center gap-[4vmin] overflow-hidden">
                                    <motion.div 
                                        animate={{ rotate: 360 }}
                                        transition={{ duration: 20, repeat: Infinity, ease: "linear" }}
                                        className="bg-emerald-50 w-[15vmin] h-[15vmin] md:w-[20vmin] md:h-[20vmin] rounded-full flex items-center justify-center border-[0.8vmin] border-emerald-600 shrink-0 text-emerald-600 shadow-xl"
                                    >
                                        <Icons.Apple className="w-[10vmin] h-[10vmin]" />
                                    </motion.div>
                                    <div className="space-y-[1vmin]">
                                        <h1 className="fluid-title font-[900] text-emerald-600 italic uppercase leading-none">Hero Plate</h1>
                                        <p className="fluid-subtitle text-slate-400 font-bold uppercase tracking-[0.3em]">Learning Quest</p>
                                    </div>
                                    <button onClick={startGame} className="w-full max-w-[40vw] bg-emerald-500 text-white py-[3vmin] rounded-full shadow-2xl active:scale-95 uppercase font-[900] fluid-button hover:bg-emerald-600 transition-colors">Start Quest</button>
                                </motion.div>
                            )}

                            {gameState === 'game' && sessionItems[currentIdx] && (
                                <motion.div key={currentIdx} initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} className="w-full max-w-[90vw] h-full max-h-[85vh] bg-white p-[4vmin] rounded-[6vmin] shadow-2xl border-[0.6vmin] border-emerald-50 flex flex-col items-center justify-between gap-[2vmin] overflow-hidden">
                                    <h2 className="fluid-question font-[900] text-emerald-600 uppercase italic shrink-0 leading-none tracking-tighter text-center mt-[2vmin]">IS IT HEALTHY?</h2>
                                    <div className="flex-1 flex items-center justify-center min-h-0 w-full overflow-hidden">
                                        <motion.div key={sessionItems[currentIdx].name} initial={{ scale: 0.5 }} animate={{ scale: 1 }} className="fluid-emoji leading-none select-none flex items-center justify-center">
                                            {sessionItems[currentIdx].icon}
                                        </motion.div>
                                    </div>
                                    <div className="flex gap-[4vmin] w-full max-w-[60vw] shrink-0 pb-[2vmin]">
                                        <button onClick={() => handleChoice('healthy')} className="flex-1 bg-emerald-500 text-white py-[3vmin] rounded-[3vmin] fluid-button font-[900] shadow-2xl active:scale-95 uppercase hover:bg-emerald-600 transition-colors">Yes</button>
                                        <button onClick={() => handleChoice('unhealthy')} className="flex-1 bg-emerald-500 text-white py-[3vmin] rounded-[3vmin] fluid-button font-[900] shadow-2xl active:scale-95 uppercase hover:bg-emerald-600 transition-colors">No</button>
                                    </div>
                                </motion.div>
                            )}

                            {gameState === 'result' && (
                                <motion.div key="result" initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} className="bg-white p-[4vmin] rounded-[6vmin] shadow-2xl w-full max-w-[85vw] h-full max-h-[90vh] text-center border-b-[2vmin] border-emerald-100 flex flex-col justify-between items-center overflow-hidden">
                                    {score >= 90 && <Confetti />}
                                    <div className="shrink-0 flex flex-col items-center pt-[1vmin]">
                                        <Icons.Trophy className={`w-[8vmin] h-[8vmin] ${score >= 90 ? 'text-yellow-500' : 'text-slate-300'} mb-[1vmin]`} />
                                        <h2 className="fluid-button font-[900] text-emerald-600 uppercase tracking-tighter leading-none">Quest Complete</h2>
                                    </div>
                                    <div className="bg-emerald-50 rounded-[4vmin] p-[3vmin] flex items-center gap-[4vmin] justify-center min-h-0 flex-1 my-[2vmin] w-full overflow-hidden border-[0.3vmin] border-emerald-100 shadow-inner">
                                        <div className="text-center bg-white p-[3vmin] rounded-[3vmin] border-[0.4vmin] border-emerald-100 shrink-0 z-10 shadow-lg">
                                            <div className={`fluid-question font-[900] ${score < 40 ? 'text-red-500' : 'text-emerald-600'} leading-none`}>{score}</div>
                                            <div className="fluid-subtitle font-black text-emerald-400 uppercase">Points</div>
                                        </div>
                                        <div className="text-left overflow-hidden z-10 flex-1">
                                            <p className={`fluid-feedback font-black ${score < 40 ? 'text-red-500' : 'text-slate-700'} leading-tight italic line-clamp-3`}>
                                                "{finalMessage}"
                                            </p>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-5 gap-[1.5vmin] mb-[2vmin] shrink-0 w-full px-[2vmin]">
                                        {userAnswers.map((item, i) => (
                                            <div key={i} className={`p-[1.5vmin] rounded-[3vmin] border-[0.3vmin] flex flex-col items-center justify-center gap-[0.5vmin] ${item.wasCorrect ? 'border-emerald-100 bg-emerald-50 shadow-emerald-100/50' : 'border-red-50 bg-red-50 shadow-red-100/50'} shadow-md`}>
                                                <span className="text-[5vmin] leading-none">{item.icon}</span>
                                                {item.wasCorrect ? <Icons.CheckCircle2 className="w-[2.5vmin] h-[2.5vmin] text-emerald-500" /> : <Icons.XCircle className="w-[2.5vmin] h-[2.5vmin] text-red-400" />}
                                            </div>
                                        ))}
                                    </div>
                                    <div className="h-fit flex items-center justify-center shrink-0 w-full">
                                        {showPlayAgain && (
                                            <motion.button 
                                                initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} 
                                                onClick={() => setGameState('menu')} 
                                                className="w-full max-w-[40vw] bg-emerald-500 text-white py-[2.5vmin] rounded-full fluid-button font-[900] shadow-2xl flex items-center justify-center gap-[2vmin] active:scale-95 uppercase tracking-wider hover:bg-emerald-600 transition-colors mb-[1vmin]"
                                            >
                                                <Icons.RefreshCcw size="3.5vmin" /> Play Again
                                            </motion.button>
                                        )}
                                    </div>
                                </motion.div>
                            )}
                        </AnimatePresence>
                    </main>
                    <div className="fixed -bottom-[20vmin] -left-[20vmin] w-[50vmin] h-[50vmin] bg-emerald-100/20 rounded-full blur-[10vmin] pointer-events-none" />
                    <div className="fixed -top-[20vmin] -right-[20vmin] w-[50vmin] h-[50vmin] bg-emerald-100/20 rounded-full blur-[10vmin] pointer-events-none" />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

                        if (gameState !== 'menu') {
                            setGameState('menu');
                        }
                    }, 180000); // 180,000 ms = 3 minutes
                };

                if (gameState !== 'menu') {
                    resetTimer();
                    window.addEventListener('mousemove', resetTimer);
                    window.addEventListener('mousedown', resetTimer);
                    window.addEventListener('touchstart', resetTimer);
                    window.addEventListener('keydown', resetTimer);
                }

                return () => {
                    if (idleTimeout) clearTimeout(idleTimeout);
                    window.removeEventListener('mousemove', resetTimer);
                    window.removeEventListener('mousedown', resetTimer);
                    window.removeEventListener('touchstart', resetTimer);
                    window.removeEventListener('keydown', resetTimer);
                };
            }, [gameState]);

            useEffect(() => {
                const checkOrientation = () => setOrientation(window.innerWidth > window.innerHeight ? 'landscape' : 'portrait');
                const handleFSChange = () => setIsFullscreen(!!document.fullscreenElement);
                window.addEventListener('resize', checkOrientation);
                document.addEventListener('fullscreenchange', handleFSChange);
                checkOrientation();
                return () => {
                    window.removeEventListener('resize', checkOrientation);
                    document.removeEventListener('fullscreenchange', handleFSChange);
                };
            }, []);

            useEffect(() => {
                if (gameState === 'result') {
                    setShowPlayAgain(false);
                    const timer = setTimeout(() => setShowPlayAgain(true), 1200);
                    return () => clearTimeout(timer);
                }
            }, [gameState]);

            const toggleFullScreen = () => {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(() => {});
                } else {
                    if (document.exitFullscreen) document.exitFullscreen();
                }
            };

            const startGame = () => {
                const shuffledItems = [...ITEM_BANK].sort(() => 0.5 - Math.random()).slice(0, 10);
                setSessionItems(shuffledItems);
                setScore(0);
                setCurrentIdx(0);
                setUserAnswers([]);
                setGameState('game');
            };

            const handleChoice = (choice) => {
                const currentItem = sessionItems[currentIdx];
                const isCorrect = currentItem.type === choice;
                const newScore = isCorrect ? score + 10 : score;
                setScore(newScore);
                
                const updatedAnswers = [...userAnswers, { ...currentItem, wasCorrect: isCorrect }];
                setUserAnswers(updatedAnswers);

                if (currentIdx < 9) {
                    setCurrentIdx(currentIdx + 1);
                } else {
                    if (newScore >= 90) {
                        setFinalMessage(MESSAGE_BANK[Math.floor(Math.random() * MESSAGE_BANK.length)]);
                    } else if (newScore >= 60 && newScore <= 80) {
                        setFinalMessage("Good enough, but let's try to make better, healthier choices next time!");
                    } else if (newScore <= 30) {
                        setFinalMessage("Not good enough! You can do much better! Try choosing healthier food next time!");
                    } else {
                        setFinalMessage("You are learning! Practice choosing healthy snacks to get even stronger!");
                    }
                    setTimeout(() => setGameState('result'), 500);
                }
            };

            return (
                <div className="fixed inset-0 bg-emerald-50 hero-gradient overflow-hidden flex flex-col h-[100dvh]">
                    {orientation === 'portrait' && gameState === 'game' && (
                        <div className="fixed inset-0 z-[100] bg-slate-900 flex flex-col items-center justify-center text-white p-6 text-center">
                            <Icons.Smartphone className="w-12 h-12 mb-4 animate-bounce text-emerald-400" />
                            <p className="font-bold uppercase tracking-widest text-sm text-amber-500 text-2xl">Rotate Screen for Landscape</p>
                        </div>
                    )}

                    <button 
                        onClick={toggleFullScreen} 
                        className="fixed top-6 right-6 z-[110] bg-white/95 backdrop-blur p-4 rounded-full shadow-2xl border-2 border-emerald-100 text-emerald-600 active:scale-95 transition-all flex items-center justify-center"
                        aria-label={isFullscreen ? "Exit Full Screen" : "Enter Full Screen"}
                    >
                        {isFullscreen ? <Icons.Minimize size={32} /> : <Icons.Maximize size={32} />}
                    </button>

                    {gameState === 'game' && (
                        <header className="flex-none p-4 md:p-8 flex justify-between items-center bg-white/80 backdrop-blur-sm border-b border-emerald-100 z-10 pr-20 md:pr-32">
                            <div className="flex items-center gap-4 bg-white px-6 py-3 rounded-2xl border-[4px] border-emerald-200 shadow-lg">
                                <Icons.Star className="w-8 h-8 md:w-12 md:h-12 text-yellow-500" fill="currentColor" />
                                <span className="fluid-points font-[900] text-emerald-600 leading-none">{score}</span>
                            </div>
                            <div className="flex-1 max-w-[200px] md:max-w-md mx-6">
                                <div className="bg-slate-200 h-3 md:h-5 rounded-full overflow-hidden border-2 border-white shadow-inner">
                                    <div style={{ width: `${(currentIdx / 10) * 100}%` }} className="bg-emerald-500 h-full transition-all duration-300" />
                                </div>
                            </div>
                            <div className="text-xl md:text-3xl font-black text-slate-400 uppercase tracking-widest hidden lg:block">
                                {currentIdx + 1} / 10
                            </div>
                        </header>
                    )}

                    <main className="flex-1 relative flex items-center justify-center p-4 overflow-hidden">
                        <AnimatePresence mode="wait">
                            {gameState === 'menu' && (
                                <motion.div key="menu" initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} className="w-full max-w-4xl bg-white p-8 md:p-16 rounded-[3rem] shadow-2xl border-b-[12px] border-emerald-100 text-center space-y-8 flex flex-col items-center justify-center max-h-[90vh] overflow-hidden">
                                    <motion.div 
                                        animate={{ rotate: 360 }}
                                        transition={{ duration: 20, repeat: Infinity, ease: "linear" }}
                                        className="bg-emerald-50 w-24 h-24 md:w-40 md:h-40 rounded-full flex items-center justify-center border-[6px] border-emerald-600 shrink-0 text-emerald-600 shadow-xl"
                                    >
                                        <Icons.Apple className="w-16 h-16 md:w-24 md:h-24" />
                                    </motion.div>
                                    <div className="space-y-2">
                                        <h1 className="fluid-title font-[900] text-emerald-600 italic uppercase leading-none">Hero Plate</h1>
                                        <p className="text-xl md:text-2xl text-slate-400 font-bold uppercase tracking-[0.3em]">Learning Quest</p>
                                    </div>
                                    <button onClick={startGame} className="w-full max-w-lg bg-emerald-500 text-white text-2xl md:text-5xl font-[900] py-6 md:py-10 rounded-full shadow-2xl active:scale-95 uppercase tracking-tighter hover:bg-emerald-600 transition-colors">Start Quest</button>
                                </motion.div>
                            )}

                            {gameState === 'game' && sessionItems[currentIdx] && (
                                <motion.div key={currentIdx} initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} className="w-full max-w-6xl h-full max-h-[85vh] bg-white p-6 md:p-12 rounded-[4rem] shadow-2xl border-[6px] border-emerald-50 flex flex-col items-center justify-between gap-4 overflow-hidden">
                                    <h2 className="fluid-question font-[900] text-emerald-600 uppercase italic shrink-0 leading-none mt-4 md:mt-8 tracking-tighter text-center">IS IT HEALTHY?</h2>
                                    <div className="flex-1 flex items-center justify-center min-h-0 w-full overflow-hidden">
                                        <motion.div key={sessionItems[currentIdx].name} initial={{ scale: 0.5 }} animate={{ scale: 1 }} className="fluid-emoji leading-none select-none flex items-center justify-center">
                                            {sessionItems[currentIdx].icon}
                                        </motion.div>
                                    </div>
                                    <div className="flex gap-8 w-full max-w-4xl shrink-0 pb-4">
                                        <button onClick={() => handleChoice('healthy')} className="flex-1 bg-emerald-500 text-white py-6 md:py-12 rounded-[2rem] text-3xl md:text-6xl font-[900] shadow-2xl active:scale-95 uppercase hover:bg-emerald-600 transition-colors">Yes</button>
                                        <button onClick={() => handleChoice('unhealthy')} className="flex-1 bg-emerald-500 text-white py-6 md:py-12 rounded-[2rem] text-3xl md:text-6xl font-[900] shadow-2xl active:scale-95 uppercase hover:bg-emerald-600 transition-colors">No</button>
                                    </div>
                                </motion.div>
                            )}

                            {gameState === 'result' && (
                                <motion.div key="result" initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} className="bg-white p-6 md:p-12 rounded-[4rem] shadow-2xl max-w-6xl w-full h-full max-h-[92vh] text-center border-b-[15px] border-emerald-100 flex flex-col justify-between overflow-hidden">
                                    {score >= 90 && <Confetti />}
                                    <div className="shrink-0 flex flex-col items-center pt-2">
                                        <Icons.Trophy className={`w-16 h-16 md:w-24 md:h-24 ${score >= 90 ? 'text-yellow-500' : 'text-slate-300'} mb-2`} />
                                        <h2 className="text-3xl md:text-6xl font-[900] text-emerald-600 uppercase tracking-tighter leading-none">Quest Complete</h2>
                                    </div>
                                    <div className="bg-emerald-50 rounded-[2.5rem] p-6 md:p-10 flex items-center gap-8 justify-center min-h-0 flex-1 my-4 overflow-hidden relative border-2 border-emerald-100 shadow-inner">
                                        <div className="text-center bg-white p-6 md:p-10 rounded-[2rem] border-[4px] border-emerald-100 shrink-0 z-10 shadow-lg">
                                            <div className={`text-5xl md:text-9xl font-[900] ${score < 40 ? 'text-red-500' : 'text-emerald-600'} leading-none`}>{score}</div>
                                            <div className="text-sm md:text-xl font-black text-emerald-400 uppercase mt-2">Points</div>
                                        </div>
                                        <div className="text-left overflow-hidden z-10">
                                            <p className={`text-2xl md:text-5xl font-black ${score < 40 ? 'text-red-500' : 'text-slate-700'} leading-tight italic`}>
                                                "{finalMessage}"
                                            </p>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-5 gap-3 mb-6 shrink-0 px-2">
                                        {userAnswers.map((item, i) => (
                                            <div key={i} className={`p-3 md:p-6 rounded-[2rem] border-[3px] flex flex-col items-center gap-2 ${item.wasCorrect ? 'border-emerald-100 bg-emerald-50 shadow-emerald-100/50' : 'border-red-50 bg-red-50 shadow-red-100/50'} shadow-md`}>
                                                <span className="text-4xl md:text-7xl">{item.icon}</span>
                                                <div className="flex items-center gap-1">{item.wasCorrect ? <Icons.CheckCircle2 className="w-6 h-6 md:w-10 md:h-10 text-emerald-500" /> : <Icons.XCircle className="w-6 h-6 md:w-10 md:h-10 text-red-400" />}</div>
                                            </div>
                                        ))}
                                    </div>
                                    <div className="h-20 md:h-32 flex items-center justify-center shrink-0 w-full overflow-hidden">
                                        {showPlayAgain && (
                                            <motion.button 
                                                initial={{ opacity: 0, y: 20 }} 
                                                animate={{ opacity: 1, y: 0 }} 
                                                onClick={() => setGameState('menu')} 
                                                className="w-full max-w-lg bg-emerald-500 text-white py-6 md:py-8 rounded-full text-2xl md:text-4xl font-[900] shadow-2xl flex items-center justify-center gap-4 active:scale-95 uppercase tracking-wider hover:bg-emerald-600 transition-colors"
                                            >
                                                <Icons.RefreshCcw size={32} /> Play Again
                                            </motion.button>
                                        )}
                                    </div>
                                </motion.div>
                            )}
                        </AnimatePresence>
                    </main>
                    <div className="fixed -bottom-80 -left-80 w-[40rem] h-[40rem] bg-emerald-100/20 rounded-full blur-[150px] pointer-events-none" />
                    <div className="fixed -top-80 -right-80 w-[40rem] h-[40rem] bg-emerald-100/20 rounded-full blur-[150px] pointer-events-none" />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

                { type: 'healthy', icon: 'ðŸŽ', name: 'Apple' },
                { type: 'unhealthy', icon: 'ðŸ­', name: 'Candy' },
                { type: 'healthy', icon: 'ðŸ¥¦', name: 'Broccoli' },
                { type: 'healthy', icon: 'ðŸ’§', name: 'Water' },
                { type: 'unhealthy', icon: 'ðŸ¥¤', name: 'Soda' },
                { type: 'healthy', icon: 'ðŸ¥•', name: 'Carrot' },
                { type: 'unhealthy', icon: 'ðŸ•', name: 'Pizza' },
                { type: 'healthy', icon: 'ðŸŒ', name: 'Banana' },
                { type: 'unhealthy', icon: 'ðŸ©', name: 'Donut' },
                { type: 'healthy', icon: 'ðŸ“', name: 'Strawberry' },
                { type: 'unhealthy', icon: 'ðŸŸ', name: 'Fries' },
                { type: 'healthy', icon: 'ðŸ¥š', name: 'Egg' },
                { type: 'unhealthy', icon: 'ðŸ”', name: 'Burger' },
                { type: 'healthy', icon: 'ðŸ‰', name: 'Watermelon' },
                { type: 'unhealthy', icon: 'ðŸ¦', name: 'Ice Cream' },
                { type: 'healthy', icon: 'ðŸ‡', name: 'Grapes' },
                { type: 'healthy', icon: 'ðŸŒ½', name: 'Corn' },
                { type: 'healthy', icon: 'ðŸŠ', name: 'Orange' },
                { type: 'unhealthy', icon: 'ðŸ°', name: 'Cake' },
                { type: 'unhealthy', icon: 'ðŸŒ­', name: 'Hot Dog' }
            ];

            const MESSAGE_BANK = [
                "You are doing a great job with your choices!",
                "Nice work picking good fuel for your body!",
                "You are learning so much about healthy food!",
                "Great effort on choosing your power-ups!"
            ];

            useEffect(() => {
                const checkOrientation = () => setOrientation(window.innerWidth > window.innerHeight ? 'landscape' : 'portrait');
                const handleFSChange = () => setIsFullscreen(!!document.fullscreenElement);
                window.addEventListener('resize', checkOrientation);
                document.addEventListener('fullscreenchange', handleFSChange);
                checkOrientation();
                return () => {
                    window.removeEventListener('resize', checkOrientation);
                    document.removeEventListener('fullscreenchange', handleFSChange);
                };
            }, []);

            useEffect(() => {
                if (gameState === 'result') {
                    setShowPlayAgain(false);
                    const timer = setTimeout(() => setShowPlayAgain(true), 1200);
                    return () => clearTimeout(timer);
                }
            }, [gameState]);

            const toggleFullScreen = () => {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(() => {});
                } else {
                    if (document.exitFullscreen) document.exitFullscreen();
                }
            };

            const startGame = () => {
                const shuffledItems = [...ITEM_BANK].sort(() => 0.5 - Math.random()).slice(0, 10);
                setSessionItems(shuffledItems);
                setScore(0);
                setCurrentIdx(0);
                setUserAnswers([]);
                setGameState('game');
            };

            const handleChoice = (choice) => {
                const currentItem = sessionItems[currentIdx];
                const isCorrect = currentItem.type === choice;
                const newScore = isCorrect ? score + 10 : score;
                setScore(newScore);
                
                const updatedAnswers = [...userAnswers, { ...currentItem, wasCorrect: isCorrect }];
                setUserAnswers(updatedAnswers);

                if (currentIdx < 9) {
                    setCurrentIdx(currentIdx + 1);
                } else {
                    if (newScore >= 90) {
                        setFinalMessage(MESSAGE_BANK[Math.floor(Math.random() * MESSAGE_BANK.length)]);
                    } else if (newScore >= 60 && newScore <= 80) {
                        setFinalMessage("Good enough, but let's try to make better, healthier choices next time!");
                    } else if (newScore <= 30) {
                        setFinalMessage("Not good enough! You can do much better! Try choosing healthier food next time!");
                    } else {
                        setFinalMessage("You are learning! Practice choosing healthy snacks to get even stronger!");
                    }
                    setTimeout(() => setGameState('result'), 500);
                }
            };

            return (
                <div className="fixed inset-0 bg-emerald-50 hero-gradient overflow-hidden flex flex-col h-[100dvh]">
                    {orientation === 'portrait' && gameState === 'game' && (
                        <div className="fixed inset-0 z-[100] bg-slate-900 flex flex-col items-center justify-center text-white p-6 text-center">
                            <Icons.Smartphone className="w-12 h-12 mb-4 animate-bounce text-emerald-400" />
                            <p className="font-bold uppercase tracking-widest text-sm text-amber-500 text-2xl">Rotate Screen for Landscape</p>
                        </div>
                    )}

                    <button 
                        onClick={toggleFullScreen} 
                        className="fixed top-6 right-6 z-[110] bg-white/95 backdrop-blur p-4 rounded-full shadow-2xl border-2 border-emerald-100 text-emerald-600 active:scale-95 transition-all flex items-center justify-center"
                        aria-label={isFullscreen ? "Exit Full Screen" : "Enter Full Screen"}
                    >
                        {isFullscreen ? <Icons.Minimize size={32} /> : <Icons.Maximize size={32} />}
                    </button>

                    {gameState === 'game' && (
                        <header className="flex-none p-4 md:p-8 flex justify-between items-center bg-white/80 backdrop-blur-sm border-b border-emerald-100 z-10 pr-20 md:pr-32">
                            <div className="flex items-center gap-4 bg-white px-6 py-3 rounded-2xl border-[4px] border-emerald-200 shadow-lg">
                                <Icons.Star className="w-8 h-8 md:w-12 md:h-12 text-yellow-500" fill="currentColor" />
                                <span className="fluid-points font-[900] text-emerald-600 leading-none">{score}</span>
                            </div>
                            <div className="flex-1 max-w-[200px] md:max-w-md mx-6">
                                <div className="bg-slate-200 h-3 md:h-5 rounded-full overflow-hidden border-2 border-white shadow-inner">
                                    <div style={{ width: `${(currentIdx / 10) * 100}%` }} className="bg-emerald-500 h-full transition-all duration-300" />
                                </div>
                            </div>
                            <div className="text-xl md:text-3xl font-black text-slate-400 uppercase tracking-widest hidden lg:block">
                                {currentIdx + 1} / 10
                            </div>
                        </header>
                    )}

                    <main className="flex-1 relative flex items-center justify-center p-4 overflow-hidden">
                        <AnimatePresence mode="wait">
                            {gameState === 'menu' && (
                                <motion.div key="menu" initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} className="w-full max-w-4xl bg-white p-8 md:p-16 rounded-[3rem] shadow-2xl border-b-[12px] border-emerald-100 text-center space-y-8 flex flex-col items-center justify-center max-h-[90vh] overflow-hidden">
                                    <motion.div 
                                        animate={{ rotate: 360 }}
                                        transition={{ duration: 20, repeat: Infinity, ease: "linear" }}
                                        className="bg-emerald-50 w-24 h-24 md:w-40 md:h-40 rounded-full flex items-center justify-center border-[6px] border-emerald-600 shrink-0 text-emerald-600 shadow-xl"
                                    >
                                        <Icons.Apple className="w-16 h-16 md:w-24 md:h-24" />
                                    </motion.div>
                                    <div className="space-y-2">
                                        <h1 className="fluid-title font-[900] text-emerald-600 italic uppercase leading-none">Hero Plate</h1>
                                        <p className="text-xl md:text-2xl text-slate-400 font-bold uppercase tracking-[0.3em]">Learning Quest</p>
                                    </div>
                                    <button onClick={startGame} className="w-full max-w-lg bg-emerald-500 text-white text-2xl md:text-5xl font-[900] py-6 md:py-10 rounded-full shadow-2xl active:scale-95 uppercase tracking-tighter hover:bg-emerald-600 transition-colors">Start Quest</button>
                                </motion.div>
                            )}

                            {gameState === 'game' && sessionItems[currentIdx] && (
                                <motion.div key={currentIdx} initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} className="w-full max-w-6xl h-full max-h-[85vh] bg-white p-6 md:p-12 rounded-[4rem] shadow-2xl border-[6px] border-emerald-50 flex flex-col items-center justify-between gap-4 overflow-hidden">
                                    <h2 className="fluid-question font-[900] text-emerald-600 uppercase italic shrink-0 leading-none mt-4 md:mt-8 tracking-tighter text-center">IS IT HEALTHY?</h2>
                                    <div className="flex-1 flex items-center justify-center min-h-0 w-full overflow-hidden">
                                        <motion.div key={sessionItems[currentIdx].name} initial={{ scale: 0.5 }} animate={{ scale: 1 }} className="fluid-emoji leading-none select-none flex items-center justify-center">
                                            {sessionItems[currentIdx].icon}
                                        </motion.div>
                                    </div>
                                    <div className="flex gap-8 w-full max-w-4xl shrink-0 pb-4">
                                        <button onClick={() => handleChoice('healthy')} className="flex-1 bg-emerald-500 text-white py-6 md:py-12 rounded-[2rem] text-3xl md:text-6xl font-[900] shadow-2xl active:scale-95 uppercase hover:bg-emerald-600 transition-colors">Yes</button>
                                        <button onClick={() => handleChoice('unhealthy')} className="flex-1 bg-emerald-500 text-white py-6 md:py-12 rounded-[2rem] text-3xl md:text-6xl font-[900] shadow-2xl active:scale-95 uppercase hover:bg-emerald-600 transition-colors">No</button>
                                    </div>
                                </motion.div>
                            )}

                            {gameState === 'result' && (
                                <motion.div key="result" initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} className="bg-white p-6 md:p-12 rounded-[4rem] shadow-2xl max-w-6xl w-full h-full max-h-[92vh] text-center border-b-[15px] border-emerald-100 flex flex-col justify-between overflow-hidden">
                                    {score >= 90 && <Confetti />}
                                    <div className="shrink-0 flex flex-col items-center pt-2">
                                        <Icons.Trophy className={`w-16 h-16 md:w-24 md:h-24 ${score >= 90 ? 'text-yellow-500' : 'text-slate-300'} mb-2`} />
                                        <h2 className="text-3xl md:text-6xl font-[900] text-emerald-600 uppercase tracking-tighter leading-none">Quest Complete</h2>
                                    </div>
                                    <div className="bg-emerald-50 rounded-[2.5rem] p-6 md:p-10 flex items-center gap-8 justify-center min-h-0 flex-1 my-4 overflow-hidden relative border-2 border-emerald-100 shadow-inner">
                                        <div className="text-center bg-white p-6 md:p-10 rounded-[2rem] border-[4px] border-emerald-100 shrink-0 z-10 shadow-lg">
                                            <div className={`text-5xl md:text-9xl font-[900] ${score < 40 ? 'text-red-500' : 'text-emerald-600'} leading-none`}>{score}</div>
                                            <div className="text-sm md:text-xl font-black text-emerald-400 uppercase mt-2">Points</div>
                                        </div>
                                        <div className="text-left overflow-hidden z-10">
                                            <p className={`text-2xl md:text-5xl font-black ${score < 40 ? 'text-red-500' : 'text-slate-700'} leading-tight italic`}>
                                                "{finalMessage}"
                                            </p>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-5 gap-3 mb-6 shrink-0 px-2">
                                        {userAnswers.map((item, i) => (
                                            <div key={i} className={`p-3 md:p-6 rounded-[2rem] border-[3px] flex flex-col items-center gap-2 ${item.wasCorrect ? 'border-emerald-100 bg-emerald-50 shadow-emerald-100/50' : 'border-red-50 bg-red-50 shadow-red-100/50'} shadow-md`}>
                                                <span className="text-4xl md:text-7xl">{item.icon}</span>
                                                <div className="flex items-center gap-1">{item.wasCorrect ? <Icons.CheckCircle2 className="w-6 h-6 md:w-10 md:h-10 text-emerald-500" /> : <Icons.XCircle className="w-6 h-6 md:w-10 md:h-10 text-red-400" />}</div>
                                            </div>
                                        ))}
                                    </div>
                                    <div className="h-20 md:h-32 flex items-center justify-center shrink-0 w-full overflow-hidden">
                                        {showPlayAgain && (
                                            <motion.button 
                                                initial={{ opacity: 0, y: 20 }} 
                                                animate={{ opacity: 1, y: 0 }} 
                                                onClick={() => setGameState('menu')} 
                                                className="w-full max-w-lg bg-emerald-500 text-white py-6 md:py-8 rounded-full text-2xl md:text-4xl font-[900] shadow-2xl flex items-center justify-center gap-4 active:scale-95 uppercase tracking-wider hover:bg-emerald-600 transition-colors"
                                            >
                                                <Icons.RefreshCcw size={32} /> Play Again
                                            </motion.button>
                                        )}
                                    </div>
                                </motion.div>
                            )}
                        </AnimatePresence>
                    </main>
                    <div className="fixed -bottom-80 -left-80 w-[40rem] h-[40rem] bg-emerald-100/20 rounded-full blur-[150px] pointer-events-none" />
                    <div className="fixed -top-80 -right-80 w-[40rem] h-[40rem] bg-emerald-100/20 rounded-full blur-[150px] pointer-events-none" />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

